<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>

  <body>
    <button id="debounceBtn">å•å‡»</button>
    <!-- æ‰å¹³åŒ– -->
    <script>
      // å¤šç»´æ•°ç»„è½¬åŒ–ä¸€ä½æ•°ç»„ æ•°æ®æ¨¡æ¿
      var data = [1, [1, 2, 3, [1, 2, 4]]];

      // æ•°ç»„å»é‡data
      var data2 = [1, 2, 3, 5, 1];
      // æ‰‹å†™æ–¹æ³•ç±»
      class HandQuestion {
        constructor() {}
        static print(msg) {
          console.log("ç»“æœ:", msg);
        }

        // æ€è·¯ï¼š
        // 1.éå†æ•°ç»„
        // 2.åˆ¤æ–­æ˜¯å¦æ˜¯æ•°ç»„
        // 3.æ˜¯ é€’å½’ å¦ç›´æ¥æ·»åŠ 
        static handleOneArray(arr) {
          let result = [];
          for (let i = 0; i < arr.length; i++) {
            let item = arr[i];
            if (Array.isArray(item)) {
              result.push(...HandQuestion.handleOneArray(item));
            } else {
              result.push(item);
            }
          }
          return result;
        }

        // æ•°ç»„å»é‡
        // ğŸŒ°ï¼š[1,2,3,4,1]=>[1,2,3,4]
        // æ€è·¯ï¼š
        // Setï¼Œæ•°ç»„indexOf,include,åˆ©ç”¨Map
        static handleUniqueArray(data) {
          var result = new Set(data);
          console.log([...result]);
          return [...result];
        }
      }

      //æµ‹è¯•ç‚¹1ï¼š
      HandQuestion.handleOneArray(data);

      // æµ‹è¯•ç‚¹2ï¼š
      HandQuestion.handleUniqueArray(data2);

      // æ‰‹å†™Arrayçš„æ–¹æ³• åŒ…æ‹¬filter reduce map forEach includes

      // æ‰‹å†™filteré€»è¾‘æ€è·¯
      // 1.å¥å£®æ€§æ ¡éªŒ thisã€å›è°ƒæ ¡éªŒ
      // 2.èµ‹å€¼ this\é•¿åº¦len
      // 3.éå†
      // 4.åˆ¤æ–­callbackè¿”å›å€¼æ˜¯å¦ä¸ºtrue
      // å¤‡æ³¨ thisArg æ˜¯å•¥
      Array.prototype.myFilter = function (callback, thisArg) {
        var result = [];
        if (this == undefined) {
          throw new TypeError("ç±»å‹é”™è¯¯");
        }
        if (typeof callback != "function") {
          throw new TypeError(callback, "is not a function");
        }
        const o = Object(this);
        const len = o.length;
        for (let i = 0; i < len; i++) {
          let item = o[i];
          if (callback(item, i, o)) {
            result.push(item);
          }
        }
        return result;
      };
      console.log([1, 2, 41].myFilter((item) => item > 10));

      // æ‰‹å†™mapé€»è¾‘æ€è·¯ mapçš„ä½¿ç”¨  [1,2,34,5].map((item)=>{item*5})è¾“å‡º [5,10,170,25];

      // é€»è¾‘æ€è·¯ ä¸»è¦ç”¨åˆ°å‡½æ•°çš„callæ–¹æ³•
      //

      Array.prototype.myMap = function (callback, context) {
        var result = [];
        const me = this;
        const ctx = context ? context : this;
        if (this == undefined) {
          throw new TypeError("ç±»å‹é”™è¯¯");
        }
        if (typeof callback != "function") {
          throw new TypeError(callback, "is not a function");
        }

        const o = Object(this);
        const len = o.length;
        for (let i = 0; i < len; i++) {
          let item = o[i];
          // if(callback(item,i,o)){
          //     result.push(callback(item,i,o));
          // }
          result.push(callback.call(ctx, item, i, this));
        }
        return result;
      };

      console.log(
        [1, 2, 41].myMap((item) => item * 3),
        this
      );

      // æ‰‹å†™éå† forEachçš„ä½¿ç”¨ [1,2,34].forEach((item)=>{console.log(item)});

      // 7.æ‰‹å†™reduce
      //8. æ‰‹å†™applyæ–¹æ³•  ä½¿ç”¨ fn.apply(this,[1,2,34,5])
      // 1.applyæ˜¯åœ¨ Function.prototypeä¸Šçš„
      function sayHi(a) {
        console.log(this);
        console.log(a);
      }
      sayHi.apply({ name: "ç‹è²" }, [1]);

      // æ‰‹å†™applyé€»è¾‘æ€è·¯

      // 1.ä¼ å€¼
      //

      // æ‰‹å†™é˜²æŠ–å‡½æ•°
      const debounce = function (fn, timeout = 1000) {
        let timeId = null;
        return function (arguments) {
          if (timeId) {
            clearTimeout(timeId);
          }
          timeId = setTimeout(() => {
            console.log("æˆ‘æ˜¯é˜²æŠ–", timeout);
            fn.apply(this, arguments);
          }, timeout);
        };
      };
      const debounceBtn = document.querySelector("#debounceBtn");
      debounceBtn.addEventListener(
        "click",
        debounce(function () {
          console.log("ä½ å¥½");
        })
      );
      console.log(function sayName(a, b, c) {}.length);

      /// èŠ‚æµ
    </script>
    <script>
      // æ‰‹å†™new
      function myNew(ctr, ...arguments) {
        if (typeof ctr != "function") {
          throw new Error("æ„é€ å‡½æ•°å¿…é¡»æ˜¯å‡½æ•°");
        }
        var target = {};
        target.__proto__ = ctr.prototype;
        let result = ctr.apply(target, arguments);
        if (typeof result === "function" || typeof result === "object") {
          return result;
        }
        return target;
      }
      class Chicken {
        constructor(name) {
          this.name = name;
        }
      }
      function Cow(name, age) {
        this.name = name;
        this.age;
      }
      Cow.prototype.swim = function () {
        console.log("ç‰›ä¼šæ¸¸æ³³");
      };
      var waterCow = myNew(Cow, "æ°´ç‰›", 25);
      console.log(waterCow);
      waterCow.swim();
    </script>
    <script>
      // æ‰‹å†™instanceof array instanceof Array true
      // æ€ä¹ˆåˆ¤æ–­
      console.log("fas" instanceof String);
      console.log(2 instanceof Number);
      console.log("fas".__proto__.constructor === String);
      console.log(typeof String);
      console.log([] instanceof Array);
      console.log({} instanceof Object);
      console.log(/\w{3}/gi instanceof RegExp);
      console.log(undefined instanceof Object);

      class A {}
      class B extends A {}
      class C extends B {}
      var c = new C();
      function myInstanceOf(left, right) {
        if (typeof left != "object" || left === null) return false;
        var proto = Object.getPrototypeOf(left);

        while (true) {
          if (proto === null) return false;
          if (proto === right.prototype) return true;
          proto = Object.getPrototypeOf(proto);
          console.log(proto);
        }
      }
      // console.log(c.__proto__)
      // console.log(Object.getPrototypeOf(c))
      // console.log(c instanceof A);
      console.log(myInstanceOf(c, A));
    </script>

    <script>
      // æ‰‹å†™å¯„ç”Ÿç»„åˆç»§æ‰¿
      function Car() {
        this.name = "";
      }

      function Bike(name, size) {
        Car.call(this, name);
        this.size = size;
      }

      //
      Bike.prototype = Object.create(Car.prototype);
      Bike.prototype.constructor = Bike;
      Bike.prototype.run = function () {
        console.log("æˆ‘æ­£åœ¨ç–¾é©°");
      };
      var bike = new Bike("å¥¥è¿ª", 25);
    </script>
    <script>
      // Object.is(); åˆ¤æ–­-0 +0 NaN

      function isObject(x, y) {}
    </script>

    <script>
      // æ‰‹å†™apply
      Function.prototype.myApply = function (context) {
        if (typeof this != "function") {
          throw new Error("use a function for myApply");
        }
        context = context || Window;
        const fn = Symbol();
        context[fn] = this;
        const args = [...arguments].slice(1);
        const result = context[fn](...args);
        delete context[fn];
        return result;
      };

      // æµ‹è¯•
      function testApply(args) {
        console.log(this);
        console.log(args);
      }
      testApply.myApply(
        {
          name: "ç‹è²",
        },
        [1, 2, 3]
      );
    </script>

    <script>
      // æµ…æ‹·è´ ã€æ·±æ‹·è´

      //
      var obj = [
        {
          id: "end",
          tmpValue: [{ name: "ç‹è²" }, { name: "æ¾æ±Ÿ" }],
        },
      ];
      console.log(obj);
      // obj[0].tmpValue = [];
      // console.log(obj);
    </script>
  </body>
</html>
